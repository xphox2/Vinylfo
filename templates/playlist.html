{{ define "playlist-page" }}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlists - Vinylfo</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
{{ template "header" }}
<main>
    <div id="playlist-view" class="view">
        <h2>My Playlists</h2>
        <button id="create-playlist-btn">Create New Playlist</button>
        <div id="playlists-container"><p>Loading playlists...</p></div>
    </div>
    <div id="playlist-detail-view" class="view" style="display: none;">
        <button id="back-to-playlists">Back to Playlists</button>
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
            <h2 id="playlist-name" style="margin: 0;"></h2>
            <div class="playlist-actions">
                <button id="delete-playlist-btn">Delete Playlist</button>
                <button id="add-tracks-btn">Add Tracks</button>
                <button id="sync-youtube-btn" style="background-color: #ff0000; color: white;">YouTube Sync</button>
                <button id="play-playlist-btn">Play</button>
            </div>
        </div>
        <div id="youtube-sync-status" class="youtube-sync-status" style="display: none;">
            <div class="sync-stats">
                <span class="stat-matched"><span class="stat-count" id="yt-matched-count">0</span> Matched</span>
                <span class="stat-review"><span class="stat-count" id="yt-review-count">0</span> Needs Review</span>
                <span class="stat-unavailable"><span class="stat-count" id="yt-unavailable-count">0</span> Unavailable</span>
                <span class="stat-pending"><span class="stat-count" id="yt-pending-count">0</span> Pending</span>
            </div>
        </div>
        <div id="playlist-tracks"><p>Loading tracks...</p></div>
    </div>
    <div id="add-tracks-view" class="view" style="display: none;">
        <button id="back-to-playlist">Back to Playlist</button>
        <div class="view-header">
            <h3 style="margin: 0;">Add Tracks to Playlist</h3>
            <div class="search-wrapper">
                <input type="text" id="available-track-search" class="local-search" placeholder="Search tracks...">
                <button type="button" class="search-clear" title="Clear search">&times;</button>
            </div>
        </div>
        <div class="pagination-controls">
            <div class="limit-selector">
                <label for="available-track-limit">Show:</label>
                <select id="available-track-limit">
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
            <div class="page-controls">
                <button type="button" id="available-track-prev" class="page-btn" disabled>&larr; Prev</button>
                <span id="available-track-page-info">Page 1 of 1</span>
                <button type="button" id="available-track-next" class="page-btn" disabled>Next &rarr;</button>
            </div>
        </div>
        <div id="available-tracks"><p>Loading tracks...</p></div>
    </div>
</main>
<footer>
    <p>Vinylfo - Vinyl Music Player</p>
</footer>
<div id="create-playlist-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Create New Playlist</h3>
        <input type="text" id="new-playlist-name" placeholder="Playlist Name">
        <button id="save-playlist-btn">Create</button>
    </div>
</div>

<div id="youtube-sync-modal" class="modal" style="display: none;">
    <div class="modal-content youtube-sync-modal-content">
        <span class="close-modal" id="close-youtube-sync">&times;</span>
        <h3>YouTube Playlist Sync</h3>
        <div id="youtube-sync-content">
            <div class="sync-status-section">
                <h4>Match Status</h4>
                <div class="sync-stats-large">
                    <div class="stat-box stat-matched">
                        <span class="stat-number" id="yt-matched">0</span>
                        <span class="stat-label">Matched</span>
                    </div>
                    <div class="stat-box stat-review">
                        <span class="stat-number" id="yt-review">0</span>
                        <span class="stat-label">Review</span>
                    </div>
                    <div class="stat-box stat-unavailable">
                        <span class="stat-number" id="yt-unavailable">0</span>
                        <span class="stat-label">Unavailable</span>
                    </div>
                    <div class="stat-box stat-pending">
                        <span class="stat-number" id="yt-pending">0</span>
                        <span class="stat-label">Pending</span>
                    </div>
                </div>
            </div>
            <div class="sync-actions-section">
                <button id="match-playlist-btn" class="youtube-action-btn">Match Tracks</button>
                <div class="sync-options">
                    <label><input type="checkbox" id="include-needs-review"> Include tracks needing review</label>
                </div>
                <div class="sync-options">
                    <label><input type="checkbox" id="youtube-api-fallback"> Use YouTube API as backup (uses quota)</label>
                </div>
                <div class="sync-options">
                    <label><input type="checkbox" id="force-rescan"> <strong>Force re-scan</strong> (clear existing matches)</label>
                </div>
                <button id="clear-cache-btn" class="youtube-action-btn" style="background-color: #666;">Clear Web Cache</button>
            </div>
            <div id="sync-progress" class="sync-progress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="match-progress-fill" style="width: 0%;"></div>
                </div>
                <p class="progress-text" id="match-progress-text">Matching tracks...</p>
            </div>
            <div class="sync-youtube-section" id="sync-youtube-section" style="display: none;">
                <h4>Export to YouTube</h4>
                <div class="export-options">
                    <label class="radio-label"><input type="radio" name="youtube-export" value="new" checked> Create new playlist</label>
                    <input type="text" id="new-playlist-name-yt" placeholder="YouTube playlist name" style="margin-left: 1rem;">
                </div>
                <div class="export-options" style="margin-top: 0.5rem;">
                    <label class="radio-label"><input type="radio" name="youtube-export" value="existing"> Add to existing playlist</label>
                    <input type="text" id="existing-playlist-id" placeholder="YouTube Playlist ID" style="margin-left: 1rem;" disabled>
                </div>
                <button id="sync-to-youtube-btn" class="youtube-action-btn youtube-export-btn">Sync to YouTube</button>
            </div>
            <div class="youtube-status-msg" id="youtube-status-msg"></div>
        </div>
    </div>
</div>

<div id="youtube-review-modal" class="modal" style="display: none;">
    <div class="modal-content youtube-review-modal-content">
        <span class="close-modal" id="close-youtube-review">&times;</span>
        <h3>Review YouTube Match</h3>
        <div id="review-track-info" class="review-track-info"></div>
        <h4>Candidates</h4>
        <div id="review-candidates" class="review-candidates"></div>
    </div>
</div>

<script src="/static/js/playlist.js"></script>
<script src="/static/js/playlist-youtube.js"></script>
</body>
</html>
{{ end }}
